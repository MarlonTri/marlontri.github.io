(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,i){e.exports=i(19)},17:function(e,t,i){},19:function(e,t,i){"use strict";i.r(t);var s=i(7),n=i.n(s),a=i(10),o=i.n(a),r=(i(17),i(1)),h=i(5),c=i(3),l=i(2),m=i(4),d=i(6),u=i(0),y=i(11),p=i(8);function v(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var s=0,n=function(){};return{s:n,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){r=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}var f=function(){function e(t){Object(r.a)(this,e),this.scene=t,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.buffer=5,this.velocity=new u.ub(0,0,0),this.position=new u.ub(0,0,0),this.direction=new u.ub(0,0,0),this.orientation=new u.db(0,Math.sqrt(.5),0,Math.sqrt(.5)),this.actions={moveForward:!1,moveBackward:!1,moveLeft:!1,moveRight:!1,canJump:!1},this.dampening=40,this.speed=1e4,this.meshes=[];var i=this.meshes;(new p.a).load("/Assets/spider.gltf",function(e){i.push(e.scene),t.add(e.scene)})}return Object(h.a)(e,[{key:"onKeyDown",value:function(e){switch(e.code){case"ArrowUp":case"KeyW":this.actions.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.actions.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.actions.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.actions.moveRight=!0;break;case"Space":!0===this.actions.canJump&&(this.velocity.y+=200);break;default:console.log("Unknown key input: "+e.code)}}},{key:"onKeyUp",value:function(e){switch(e.code){case"ArrowUp":case"KeyW":this.actions.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.actions.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.actions.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.actions.moveRight=!1;break;default:console.log("Unknown key input: "+e.code)}}},{key:"update",value:function(e,t,i){this.velocity.x-=this.velocity.x*this.dampening*e,this.velocity.z-=this.velocity.z*this.dampening*e,this.velocity.y-=.01*this.velocity.y*this.dampening*e,this.velocity.y-=9.8*100*e,this.direction.z=Number(this.actions.moveForward)-Number(this.actions.moveBackward),this.direction.x=Number(this.actions.moveRight)-Number(this.actions.moveLeft),this.direction.normalize(),0==this.direction.x&&0==this.direction.z||(this.direction.applyQuaternion(i.clone().invert()),this.direction.y=0,this.direction.normalize(),this.velocity.z-=this.direction.z*this.speed*e,this.velocity.x-=this.direction.x*this.speed*e),this.position.x+=-this.velocity.x*e,this.position.z+=this.velocity.z*e;var s=[],n=this.scene.children.filter(function(e){return"blossom"==e.name});if(n.length>0&&this.buffer-this.velocity.y*e>0){var a=this.position.clone();a.y=a.y+this.buffer,s=new u.gb(this.position,new u.ub(0,-1,0),0,this.buffer-this.velocity.y*e).intersectObject(n[0])}if(s.length>0?(this.position.y=s[0].point.y+this.buffer,this.velocity.y=0):this.position.y+=this.velocity.y*e,this.position.y<0&&(this.velocity.y=0,this.position.y=0,this.actions.canJump=!0),0!=this.velocity.clone().length()){var o=new u.db;o.setFromUnitVectors(new u.ub(-1,0,0),this.velocity.clone().normalize()),o.invert(),this.orientation.slerp(o,.25)}var r,h=v(this.meshes);try{for(h.s();!(r=h.n()).done;){var c=r.value;c.setRotationFromQuaternion(this.orientation),c.position.copy(this.position.clone())}}catch(l){h.e(l)}finally{h.f()}}}]),e}(),w=function(){function e(t){Object(r.a)(this,e),this.scene=t,this.meshes={stem:void 0,blossom:void 0},this.spawnRegionSize=12e3,this.count=2e3,this.ages=new Float32Array(this.count),this.scales=new Float32Array(this.count),this.phaseSpeed=.02,this.maxHeight=600;var i=new p.a;this.dummy=new u.U,this.dummyPos=new u.ub(0,0,0),this.dummyNorm=new u.ub(0,1,0),this.dummyScale=new u.ub(1,1,1);var s=this.init.bind(this);i.load("https://threejs.org/examples/models/gltf/Flower/Flower.glb",function(e){s(e)})}return Object(h.a)(e,[{key:"init",value:function(e){var t=e.scene.getObjectByName("Stem"),i=e.scene.getObjectByName("Blossom"),s=t.geometry.clone(),n=i.geometry.clone(),a=(new u.K).makeRotationX(Math.PI/2).multiply((new u.K).makeScale(7,7,7));s.applyMatrix4(a),n.applyMatrix4(a);var o=t.material,r=i.material;this.meshes.stem=new u.s(s,o,this.count),this.meshes.blossom=new u.s(n,r,this.count);for(var h=new u.i,c=[15861127,15914105,15911033,15904887,15877125],l=0;l<this.count;l++)h.setHex(c[Math.floor(Math.random()*c.length)]),this.meshes.blossom.setColorAt(l,h);this.meshes.stem.instanceMatrix.setUsage(u.l),this.meshes.blossom.instanceMatrix.setUsage(u.l),this.meshes.stem.name="stem",this.meshes.blossom.name="blossom",this.resample(),this.scene.add(this.meshes.stem),this.scene.add(this.meshes.blossom)}},{key:"resample",value:function(){for(var e=0;e<this.count;e++)this.resampleParticle(e);this.meshes.stem.instanceMatrix.needsUpdate=!0,this.meshes.blossom.instanceMatrix.needsUpdate=!0}},{key:"resampleParticle",value:function(e){this.ages[e]=Math.random(),this.scales[e]=this.scaleCurve(this.ages[e]),this.dummyPos.x=2*this.spawnRegionSize*(Math.random()-.5),this.dummyPos.z=2*this.spawnRegionSize*(Math.random()-.5),this.dummy.position.copy(this.dummyPos),this.dummy.scale.set(this.scales[e],this.scales[e],this.scales[e]),this.dummy.lookAt(this.dummyNorm),this.dummy.updateMatrix(),this.meshes.stem.setMatrixAt(e,this.dummy.matrix),this.meshes.blossom.setMatrixAt(e,this.dummy.matrix)}},{key:"scaleCurve",value:function(e){return this.maxHeight*Math.abs(this.easeOutCubic(2*(e>.5?1-e:e)))}},{key:"easeOutCubic",value:function(e){return--e*e*e+1}},{key:"updateParticle",value:function(e,t){if(this.ages[e]+=t*this.phaseSpeed,this.ages[e]>=1)return this.ages[e]=.005,this.scales[e]=this.scaleCurve(this.ages[e]),void this.resampleParticle(e);var i=this.scales[e];this.scales[e]=this.scaleCurve(this.ages[e]),this.dummyScale.set(this.scales[e]/i,this.scales[e]/i,this.scales[e]/i),this.meshes.stem.getMatrixAt(e,this.dummy.matrix),this.dummy.matrix.scale(this.dummyScale),this.meshes.stem.setMatrixAt(e,this.dummy.matrix),this.meshes.blossom.setMatrixAt(e,this.dummy.matrix)}},{key:"update",value:function(e){if(this.meshes.stem&&this.meshes.blossom){for(var t=0;t<this.count;t++)this.updateParticle(t,e);this.meshes.stem.instanceMatrix.needsUpdate=!0,this.meshes.blossom.instanceMatrix.needsUpdate=!0}}}]),e}(),g=function(e){function t(e){var i;return Object(r.a)(this,t),(i=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={},i.start=i.start.bind(Object(d.a)(Object(d.a)(i))),i.stop=i.stop.bind(Object(d.a)(Object(d.a)(i))),i.animate=i.animate.bind(Object(d.a)(Object(d.a)(i))),i.renderScene=i.renderScene.bind(Object(d.a)(Object(d.a)(i))),i.setupScene=i.setupScene.bind(Object(d.a)(Object(d.a)(i))),i.destroyContext=i.destroyContext.bind(Object(d.a)(Object(d.a)(i))),i.handleWindowResize=i.handleWindowResize.bind(Object(d.a)(Object(d.a)(i))),i}return Object(m.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){window.addEventListener("resize",this.handleWindowResize)}},{key:"componentDidMount",value:function(){this.setupScene()}},{key:"setupScene",value:function(){this.width=this.container.clientWidth,this.height=this.container.clientHeight;var e=new u.wb({antialias:!0});e.setPixelRatio(window.devicePixelRatio),e.shadowMap.enabled=!0,e.gammaOutput=!0,e.gammaFactor=2.2,e.shadowMap.type=u.W;var t=new u.ib;t.background=new u.i(8900346);var i=new u.X(60,this.width/this.height,.25,12e3);t.add(i),this.renderer=e,this.scene=t,this.camera=i,this.player=new f(t),this.sceneMap=new w(t),document.addEventListener("keydown",this.player.onKeyDown),document.addEventListener("keyup",this.player.onKeyUp);var s=new u.p(9e3,200);t.add(s);var n=new u.L(new u.Y(1e4,1e4,200,200),new u.M({color:16777215,opacity:1,transparent:!0}));n.position.y=-.1,n.rotation.x=-Math.PI/2,t.add(n);var a=new u.nb(16777215,.25);a.position.set(45,50,15),i.add(a),this.spotLight=a;var o=new u.a(3355443);o.position.set(5,3,5),this.camera.add(o),this.camera.lookAt(this.player.position.clone()),this.camera.updateProjectionMatrix(),this.camera.position.z=100;var r=new y.a(this.camera,this.renderer.domElement);r.enableDamping=!0,r.dampingFactor=.25,r.enableZoom=!0,r.zoomSpeed=2.1,r.enableKeys=!1,r.screenSpacePanning=!1,r.enableRotate=!0,r.dampingFactor=1,r.autoRotateSpeed=1.2,r.enablePan=!1,r.target.copy(this.player.position),r.update(),this.controls=r,this.renderer.setSize(this.width,this.height),this.container.appendChild(this.renderer.domElement),this.start()}},{key:"start",value:function(){this.frameId||(this.frameId=requestAnimationFrame(this.animate))}},{key:"renderScene",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"animate",value:function(){this.sceneMap.update(.01),this.frameId=requestAnimationFrame(this.animate),this.controls.update();var e=this.player.position.clone();this.player.update(.01,!0,this.camera.quaternion);var t=this.player.position.clone().sub(e);this.controls.target.copy(this.player.position),this.camera.position.addVectors(this.camera.position,t),this.renderScene()}},{key:"stop",value:function(){cancelAnimationFrame(this.frameId)}},{key:"handleWindowResize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"componentWillUnmount",value:function(){this.stop(),this.destroyContext()}},{key:"destroyContext",value:function(){this.container.removeChild(this.renderer.domElement),this.renderer.forceContextLoss(),this.renderer.context=null,this.renderer.domElement=null,this.renderer=null}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{ref:function(t){e.container=t},style:{width:"100%",height:"100%",position:"absolute",overflow:"hidden"}})}}]),t}(s.Component),k=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(g,null))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,2,1]]]);
//# sourceMappingURL=main.5d00707b.chunk.js.map